<!DOCTYPE html>
<html>
    <head>
        
        <meta charset="utf-8">
        <script src="_js/d3.js"></script>
        <script src="_js/d3.cloud.js"></script>
        <script src="_js/jquery.js"></script>

        <!-- Materialize -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.96.1/css/materialize.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.96.1/js/materialize.min.js"></script>

        <!-- Google Fonts -->
        <link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Hind:400,300,700,600,500' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="_css/design.css">
        <style>
            
        </style>

    </head>
    <body>

        <div id="container">
            <div id="logo">
                <div style="float:left;">GO|OG</div>
                <div style="float:right;" id="stars-container">
                    <i class="mdi-action-grade small" style="color:grey;opacity:0.5;"></i>
                    <i class="mdi-action-grade small" style="color:grey;opacity:0.5;"></i>
                    <i class="mdi-action-grade small" style="color:grey;opacity:0.5;"></i>
                    <i class="mdi-action-grade small" style="color:grey;opacity:0.5;"></i>
                </div>
                <div style="clear:both;"></div>
            </div>
            <div id="cloud-container">
                <div style="width:100%; text-align:center; padding:100px 0px;">
                    <h5>Guess the password for each of the hints.</h5>
                    <ul>
                      <li><h6>You will be shown some words</h6></li>
                      <li>Together, these words are the hints as to what the password might be</li>
                      <li>Using all the information, try and get as many right as possible</li>
                      <li>At the top are your stars. You get a star for each one you get right</li>
                    </ul>
                    <br>
                    <h6>Tips:</h6>
                    <ul>
                      <li>Often the hints are the password backwards</li>
                      <li>They are sometimes just part of the password</li>
                    <u/l>
                </div>
                <div>
                    <button onClick="getStarted();" class="input-button">START</button>
                </div>
            </div>
            <div class="input-container" style="display:none;">
                <input type="text" id="input-box" class="input-box" placeholder="Submit your answer" />
                <button onClick="checkAnswer();" onmouseout="giveFocus();" class="input-button">CHECK</button>
            </div>
        </div>

        <script>
            var answer = '';
            var score = 0,
                attempts = 0;

            function getStarted () {

                //bind a trigger to the input box
                $('#input-box').bind("enterKey",function(e){
                   checkAnswer()
                });
                //call the trigger on ENTER pressed in text box
                $('#input-box').keyup(function(e){
                    if(e.keyCode == 13)
                    {
                        $(this).trigger("enterKey");
                    }
                });

                $('#cloud-container').html('');
                $('.input-container').show();
                createCloud();
                giveFocus();
            }
            function giveFocus() {
              $(".input-box").focus();
            }
            function checkAnswer () {
                var attempt = $('input.input-box').val();
                if ( answer == attempt ) {
                    alert('Correct');
                    // Update score and stars.
                    attempts = 0;
                    score += 1;
                    $('#stars-container').html('');
                    for ( var i=0; i<score; i++ ) {
                        $('#stars-container').append('<i class="mdi-action-grade small" style="color:steelblue;"></i>');
                    }
                    for ( var i=score; i<4; i++ ) {
                        $('#stars-container').append('<i class="mdi-action-grade small" style="color:grey;opacity:0.5;"></i>');
                    }
                    // Clean the input box and container.
                    $('input.input-box').val('');
                    $('#cloud-container').html('');
                    createCloud();
                }
                else {
                    attempts += 1;
                    alert('Incorrect, try again. You have tried ' + attempts + ' times now.' );
                }
            }

            function createCloud () {
                
                var width = 600,
                    height = 400;

                //get the array of hintfile names
                $.getJSON("_data/knownHintFiles.json", function (json) {
                    //create a random number
                    var rand = Math.random();
                    rand *= json.length;
                    rand = Math.floor(rand);

                    answer = json[rand].replace('.hints','').replace('knownHints/','');

                    //use the random number to get an entry from the array and
                    //process the random file for the word cloud
                    $.getJSON( json[rand], function (json) {
                      
                        var fill = d3.scale.category20();  
                        d3.layout.cloud().size([width, height])
                            .words(json)
                            .padding(5)
                            .rotate( function () { return 0; } )
                            .font("Impact")
                            .fontSize( function (d) { 
                                if ( d.size/8 < 18 ) {
                                    return 18;
                                } 
                                else if ( d.size/8 > 45 ) {
                                    return 45
                                } 
                                else {
                                    return d.size/8
                                }
                            } )
                            .on("end", draw)
                            .start();

                        function draw(words) {
                            d3.select("#cloud-container").append("svg").attr("id","cloud-svg")
                                .attr("width", width)
                                .attr("height", height)
                                .append("g").attr("transform", "translate(300,250)")
                                .selectAll("text")
                                .data(words)
                                .enter().append("text")
                                .style("font-size", function (d) { return d.size + "px"; } )
                                //.style("font-family", "Impact")
                                .style("fill", function (d, i) { return fill(i); } )
                                .attr("text-anchor", "middle")
                                .attr("transform", function (d) {
                                    return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                                } )
                                .text( function (d) { return d.text; } );
                        }
                        //the plan is to highlight hints that helped others get the answer
                        $( "text" ).click( function (t) {
                            $( this ).attr('class','important')
                        });

                    });
                });
            }

            $(document).ready( function(){
                
            });

        </script>
        <!-- Google Analytics -->
        <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-59200850-2', 'auto');
        ga('send', 'pageview');

      </script>
    </body>
</html>